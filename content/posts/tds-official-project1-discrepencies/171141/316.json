{"id": 616053, "name": "Carlton D'Silva", "username": "carlton", "avatar_template": "/user_avatar/discourse.onlinedegree.iitm.ac.in/carlton/{size}/56317_2.png", "created_at": "2025-04-06T12:22:00.340Z", "cooked": "<p>To replicate the test environment:</p>\n<p>Fetch the github repo\u2019s latest commit before 18th feb use below code for that. You need to have github cli installed on your system and need authentication for certain github api enpoint access. Once authenticated and providing the appropriate repo details you can  run this code using uv.</p>\n<pre data-code-wrap=\"python\"><code class=\"lang-python\"># /// script\n# dependencies = [\n#   \"requests\",\n# ]\n# ///\n\nimport requests\nimport datetime as dt\nimport zoneinfo\nimport argparse\nimport os\nimport zipfile\n\nparser = argparse.ArgumentParser (description=\"Fetch the latest commit before a given deadline.\")\nparser.add_argument (\n    \"--owner\",\n    type=str,\n    required=True,\n    help=\"GitHub username.\"\n)\nparser.add_argument (\n    \"--repo\",\n    type=str,\n    required=True,\n    help=\"GitHub repository name.\"\n)\nparser.add_argument (\n    \"--save\",\n    type=str,\n    default=\"../github/\",\n    help=\"Path to save the zip file. Default='../github/'\"\n)\nparser.add_argument (\n    \"--extract\",\n    type=str,\n    default=\"../github/\",\n    help=\"Path to extract the zip file. Default='../github/'\"\n)\n\nargs = parser.parse_args ()\nowner = args.owner\nrepo = args.repo\nsave_path = args.save\nextract_path = args.extract\n\ndeadline = dt.datetime (2025, 2, 18, tzinfo=zoneinfo.ZoneInfo(\"Asia/Kolkata\"))\ndeadline_str = deadline.isoformat ()\n\ngithub_headers = {\n    \"Accept\": \"application/vnd.github.v3+json\",\n    \"X-GitHub-Api-Version\": \"2022-11-28\",\n    \"User-Agent\": \"fetch_git_before\",\n}\n\nurl = f\"https://api.github.com/repos/{owner}/{repo}/commits?until={deadline_str}&amp;per_page=1&amp;page=1\"\n\ntry:\n    response = requests.get (url, headers=github_headers, timeout=60)\n    response.raise_for_status ()  # Raise an error for bad responses\n\n    # Get the sha\n    commits = response.json ()\n    if commits:\n        latest_sha = commits[0][\"sha\"]\n        print (f\"Latest commit before {deadline_str}: {latest_sha}\")\n\n        # Get the zip of the commit\n        zip_url = f\"https://api.github.com/repos/{owner}/{repo}/zipball/{latest_sha}\"\n        zip_response = requests.get (zip_url, headers=github_headers, timeout=60)\n        zip_response.raise_for_status ()\n        zip_filename = f\"{latest_sha}.zip\"\n\n        # Create the directory if it doesn't exist\n        os.makedirs (save_path, exist_ok=True)\n\n        with open (save_path + zip_filename, \"wb\") as f:\n            f.write (zip_response.content)\n        print (f\"Downloaded zip file: {zip_filename}\")\n\n        # Create the directory if it doesn't exist\n        os.makedirs (extract_path, exist_ok=True)\n\n        # Extract the zip file\n        with zipfile.ZipFile (extract_path + zip_filename, \"r\") as zip_ref:\n            zip_ref.extractall (extract_path)\n        print (f\"Extracted zip file to: {extract_path}\")\n\n    else:\n        print (f\"No commits found before {deadline_str}\")\n\nexcept:\n    print(f\"Error fetching commits: {response.status_code} - {response.text}\")\n</code></pre>\n<p>Pass the required arguments to the above application and it will find the latest commit before the 18th, fetch it and unzip it to the folder you specified. Please use the appropriate arguments as specified in the application.</p>\n<p><code>docker build -t &lt;your image name&gt;   .</code></p>\n<p>Run new docker image using<br>\n<code>docker run -e AIPROXY_TOKEN=$AIPROXY_TOKEN -p 8000:8000 &lt;your image name&gt;</code></p>\n<p>Keep datagen.py and evaluate.py in same folder<br>\n<code>uv run evaluate.py --email &lt;any email&gt; --token_counter 1 --external_port 8000</code></p>\n<p>This then re-produces the exact environment how your application was  tested.<br>\nYou have to provide a token from your environment for testing.</p>\n<p>These instructions are same for everyone. So check first before posting here.</p>", "post_number": 316, "post_type": 1, "posts_count": 467, "updated_at": "2025-04-08T05:57:21.931Z", "reply_count": 4, "reply_to_post_number": 302, "quote_count": 0, "incoming_link_count": 6, "reads": 94, "readers_count": 93, "score": 68.4, "yours": false, "topic_id": 171141, "topic_slug": "tds-official-project1-discrepencies", "display_username": "Carlton D'Silva", "primary_group_name": "ds-students", "flair_name": "ds-students", "flair_url": null, "flair_bg_color": "", "flair_color": "", "flair_group_id": 294, "badges_granted": [], "version": 8, "can_edit": false, "can_delete": false, "can_recover": false, "can_see_hidden_post": false, "can_wiki": false, "link_counts": [{"url": "https://discourse.onlinedegree.iitm.ac.in/t/project-1-evaluation-second-mail-is-not-correct-and-reports-files-missing-while-they-are-present/171477/9", "internal": true, "reflection": true, "title": "Project 1 Evaluation second mail is not correct and reports files missing while they are present", "clicks": 0}], "read": false, "user_title": "Regular", "title_is_group": false, "reply_to_user": {"id": 8119, "username": "21f3002112", "name": "HariOm Pandey", "avatar_template": "/user_avatar/discourse.onlinedegree.iitm.ac.in/21f3002112/{size}/584_2.png"}, "bookmarked": false, "actions_summary": [{"id": 2, "can_act": true}, {"id": 6, "can_act": true}, {"id": 3, "can_act": true}, {"id": 4, "can_act": true}, {"id": 8, "can_act": true}, {"id": 10, "can_act": true}, {"id": 7, "can_act": true}], "moderator": false, "admin": false, "staff": false, "group_moderator": true, "user_id": 16094, "hidden": false, "trust_level": 3, "deleted_at": null, "user_deleted": false, "edit_reason": null, "can_view_edit_history": true, "wiki": false, "post_url": "/t/tds-official-project1-discrepencies/171141/316", "user_cakedate": "2023-01-25", "reactions": [], "current_user_reaction": null, "reaction_users_count": 0, "current_user_used_main_reaction": false, "can_accept_answer": false, "can_unaccept_answer": false, "accepted_answer": false, "topic_accepted_answer": null}