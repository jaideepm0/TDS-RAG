{"id": 582661, "name": "Carlton D'Silva", "username": "carlton", "avatar_template": "/user_avatar/discourse.onlinedegree.iitm.ac.in/carlton/{size}/56317_2.png", "created_at": "2025-01-21T09:02:30.157Z", "cooked": "<p><a class=\"mention\" href=\"/u/23f300327\">@23F300327</a></p>\n<p>Typically for a vercel application, and in particular for GA2-Q6, the applications are basically function calls. You are not expected to setup and run a local http server as you are doing in your code.</p>\n<p>When a call is made to the endpoint which in this scenario is /api<br>\nwith parameters, only one function is required, i.e the function that handles the get request.</p>\n<p>The rest is also automagically handled by vercel. There might be a conflict between vercel\u2019s webserver deployment and the one you explicitly have encoded in your program.</p>\n<p>That\u2019s why if you see in the course content about vercel, the simplest API service that you can launch with vercel looks something like this</p>\n<pre><code class=\"lang-auto\"># api/index.py\nimport json\nfrom http.server import BaseHTTPRequestHandler\n\nclass handler(BaseHTTPRequestHandler):\n    def do_GET(self):\n        self.send_response(200)\n        self.send_header('Content-type','application/json')\n        self.send_header(\"Access-Control-Allow-Origin\", \"*\")\n        self.end_headers()\n        self.wfile.write(json.dumps({\"message\": \"Hello!\"}).encode('utf-8'))\n        return\n</code></pre>\n<p>Notice there is no <code>if __name__ == \"__main__\":</code> code block.<br>\nThis would instruct the interpreter that this is the starting point of your module. Clearly we do not want that, we want vercel to handle all the backend server stuff because vercel might be running some preflight code before it runs your application.</p>\n<p><code>if __name__ == \"__main__\":</code> is used to execute some code <strong>only</strong> if the file was run directly, and not imported. In vercel, it might not be the starting point of the application.</p>\n<p>Try rewriting it with just the required endpoint function inside the default <code>handler</code> class. Avoid custom named classes until you can get a working prototype working using the boilerplate that has been shared.</p>\n<p>Another possible problem:<br>\nBy default, the JSON module encodes Unicode objects (such as str and Unicode) into the \\u escape sequence when generating JSON data. The GA however is expecting a serialised  UTF-8 JSON response instead. These might look the same on the screen but are not equivalent at the bytecode level. These encoding problems were covered in one of the videos that talked about encoding issues <a href=\"https://tds.s-anand.net/#/unicode\" rel=\"noopener nofollow ugc\">TDS &gt; Development Tools &gt; unicode</a></p>\n<p>So converting your output to UTF-8 might fix it.</p>\n<p>Let us know what worked. We are all learning from each other.</p>\n<p>Kind regards</p>", "post_number": 52, "post_type": 1, "posts_count": 170, "updated_at": "2025-01-21T09:02:46.584Z", "reply_count": 0, "reply_to_post_number": 50, "quote_count": 0, "incoming_link_count": 9, "reads": 94, "readers_count": 93, "score": 63.4, "yours": false, "topic_id": 161120, "topic_slug": "ga2-deployment-tools-discussion-thread-tds-jan-2025", "display_username": "Carlton D'Silva", "primary_group_name": "ds-students", "flair_name": "ds-students", "flair_url": null, "flair_bg_color": "", "flair_color": "", "flair_group_id": 294, "badges_granted": [], "version": 1, "can_edit": false, "can_delete": false, "can_recover": false, "can_see_hidden_post": false, "can_wiki": false, "link_counts": [{"url": "https://tds.s-anand.net/#/unicode", "internal": false, "reflection": false, "title": "Tools in Data Science", "clicks": 2}], "read": true, "user_title": "Regular", "title_is_group": false, "reply_to_user": {"id": 27771, "username": "23F300327", "name": "Mishkat Chougule", "avatar_template": "/user_avatar/discourse.onlinedegree.iitm.ac.in/23f300327/{size}/91361_2.png"}, "bookmarked": false, "actions_summary": [{"id": 2, "can_act": true}, {"id": 6, "can_act": true}, {"id": 3, "can_act": true}, {"id": 4, "can_act": true}, {"id": 8, "can_act": true}, {"id": 10, "can_act": true}, {"id": 7, "can_act": true}], "moderator": false, "admin": false, "staff": false, "group_moderator": true, "user_id": 16094, "hidden": false, "trust_level": 3, "deleted_at": null, "user_deleted": false, "edit_reason": null, "can_view_edit_history": true, "wiki": false, "post_url": "/t/ga2-deployment-tools-discussion-thread-tds-jan-2025/161120/52", "user_cakedate": "2023-01-25", "reactions": [], "current_user_reaction": null, "reaction_users_count": 0, "current_user_used_main_reaction": false, "can_accept_answer": false, "can_unaccept_answer": false, "accepted_answer": false, "topic_accepted_answer": null}