{"id": 597175, "name": "LAKSHAY", "username": "lakshaygarg654", "avatar_template": "/user_avatar/discourse.onlinedegree.iitm.ac.in/lakshaygarg654/{size}/129814_2.png", "created_at": "2025-02-19T17:35:57.454Z", "cooked": "<p><a class=\"mention\" href=\"/u/saransh_saini\">@Saransh_Saini</a><br>\nQ5 fixed, thanks for fixing the issue.</p>\n<p>Now we are struggling with Q8.<br>\nMY q8 is : Write a DuckDB SQL query to find all posts IDs after 2025-01-09T12:36:14.085Z with at least 1 comment with 4 useful stars, sorted. The result should be a table with a single column called <code>post_id</code> , and the relevant post IDs should be sorted in ascending order.<br>\nwhen i use below query, i get some some result, a table of post_id but error : <strong>Error</strong>: At root: Array length mismatch<br>\n<strong>Reason</strong>:  below query checking only 1st comment (<code>$[0]</code> refers to the first comment in the array) we have to check all comments not 1st.<br>\nBut when i change the query to check any one comment its giving different types of error.</p>\n<pre><code class=\"lang-auto\">WITH filtered_posts AS (\n  SELECT post_id\n  FROM social_media\n  WHERE timestamp &gt;= '2025-01-09T09:48:01.303Z'\n    AND EXISTS (\n      SELECT 1\n      FROM social_media AS sm\n      WHERE json_extract_path_text(sm.comments, '$[0].stars.useful') IS NOT NULL\n        AND CAST(json_extract_path_text(sm.comments, '$[0].stars.useful') AS INTEGER) &gt; 4\n    )\n)\nSELECT post_id\nFROM filtered_posts\nORDER BY post_id ASC;\n</code></pre>\n<p>Kindly check if any issue with Q8.<br>\nMay be my query is wrong or may be not.</p>\n<p>Thankyou</p>", "post_number": 46, "post_type": 1, "posts_count": 103, "updated_at": "2025-02-19T17:35:57.454Z", "reply_count": 1, "reply_to_post_number": 41, "quote_count": 0, "incoming_link_count": 2, "reads": 112, "readers_count": 111, "score": 52.0, "yours": false, "topic_id": 166576, "topic_slug": "ga5-data-preparation-discussion-thread-tds-jan-2025", "display_username": "LAKSHAY", "primary_group_name": "ds-students", "flair_name": "ds-students", "flair_url": null, "flair_bg_color": "", "flair_color": "", "flair_group_id": 294, "badges_granted": [], "version": 1, "can_edit": false, "can_delete": false, "can_recover": false, "can_see_hidden_post": false, "can_wiki": false, "read": true, "user_title": null, "reply_to_user": {"id": 13078, "username": "Saransh_Saini", "name": "Saransh Saini", "avatar_template": "/user_avatar/discourse.onlinedegree.iitm.ac.in/saransh_saini/{size}/123495_2.png"}, "bookmarked": false, "actions_summary": [{"id": 2, "count": 1, "can_act": true}, {"id": 6, "can_act": true}, {"id": 3, "can_act": true}, {"id": 4, "can_act": true}, {"id": 8, "can_act": true}, {"id": 10, "can_act": true}, {"id": 7, "can_act": true}], "moderator": false, "admin": false, "staff": false, "user_id": 7193, "hidden": false, "trust_level": 1, "deleted_at": null, "user_deleted": false, "edit_reason": null, "can_view_edit_history": true, "wiki": false, "post_url": "/t/ga5-data-preparation-discussion-thread-tds-jan-2025/166576/46", "user_cakedate": "2021-09-12", "reactions": [{"id": "heart", "type": "emoji", "count": 1}], "current_user_reaction": null, "reaction_users_count": 1, "current_user_used_main_reaction": false, "can_accept_answer": false, "can_unaccept_answer": false, "accepted_answer": false, "topic_accepted_answer": null}