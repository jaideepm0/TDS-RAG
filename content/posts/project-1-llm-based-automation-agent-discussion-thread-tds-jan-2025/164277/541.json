{"id": 595959, "name": "Manav Singh", "username": "Flibon", "avatar_template": "/user_avatar/discourse.onlinedegree.iitm.ac.in/flibon/{size}/119138_2.png", "created_at": "2025-02-16T13:22:14.284Z", "cooked": "<p>Hi everyone,</p>\n<p>I\u2019m running into an issue with the AI Proxy embeddings endpoint while executing the A9 task. Every time I send a POST request to:</p>\n<p>bash</p>\n<p>Copy</p>\n<pre><code class=\"lang-auto\">https://aiproxy.sanand.workers.dev/openai/v1/embeddings\n</code></pre>\n<p>I receive a <strong>401 Unauthorized</strong> response. This, in turn, causes my code to fail with a <code>KeyError: 'data'</code> because the expected JSON response doesn\u2019t include the <code>\"data\"</code> key.</p>\n<h3><a name=\"p-595959-what-ive-tried-1\" class=\"anchor\" href=\"#p-595959-what-ive-tried-1\"></a>What I\u2019ve Tried</h3>\n<ol>\n<li><strong>Token Verification:</strong></li>\n</ol>\n<ul>\n<li>I\u2019m using the <code>AIPROXY_TOKEN</code> obtained by logging in at <a href=\"https://aiproxy.sanand.workers.dev/\" rel=\"noopener nofollow ugc\">aiproxy.sanand.workers.dev</a> with my IITM email.</li>\n<li>The token is passed in the header as follows:</li>\n</ul>\n<p>python</p>\n<p>Copy</p>\n<pre><code class=\"lang-auto\">\"Authorization\": f\"Bearer {AIPROXY_TOKEN}\"\n</code></pre>\n<ul>\n<li>I added debug prints to confirm that the token is being used correctly (printing the first few characters).</li>\n</ul>\n<ol start=\"2\">\n<li><strong>API Request Details:</strong></li>\n</ol>\n<ul>\n<li>The request includes the correct <code>Content-Type: application/json</code> header.</li>\n<li>The payload is set as:</li>\n</ul>\n<p>json</p>\n<p>Copy</p>\n<pre><code class=\"lang-auto\">{\"model\": \"text-embedding-3-small\", \"input\": [\"Test\"]}\n</code></pre>\n<ul>\n<li>Despite this, the response status is consistently 401 Unauthorized.</li>\n</ul>\n<ol start=\"3\">\n<li><strong>Debug Output:</strong><br>\nHere\u2019s a snippet of the debug output:</li>\n</ol>\n<p>bash</p>\n<p>Copy</p>\n<pre><code class=\"lang-auto\">HTTP Request: POST https://aiproxy.sanand.workers.dev/openai/v1/embeddings \"HTTP/1.1 401 Unauthorized\"\n\ud83d\udd34 A9 failed: 'data'\n</code></pre>\n<p>This confirms that the issue is with the authentication rather than our processing logic.</p>\n<h3><a name=\"p-595959-what-i-suspect-2\" class=\"anchor\" href=\"#p-595959-what-i-suspect-2\"></a>What I Suspect</h3>\n<ul>\n<li>The token may be invalid, expired, or misconfigured.</li>\n<li>There could be changes in the token permissions or endpoint requirements that I\u2019m not aware of.</li>\n<li>Alternatively, there might be an issue on the server side with token validation.</li>\n</ul>\n<h3><a name=\"p-595959-request-for-help-3\" class=\"anchor\" href=\"#p-595959-request-for-help-3\"></a>Request for Help</h3>\n<p>Has anyone else encountered this issue recently? Could someone verify if there are any changes to the authentication requirements for the embeddings endpoint? Any insights or updated instructions on how to ensure the token is valid and has the proper permissions would be greatly appreciated.</p>\n<p>Thanks in advance for your assistance!</p>", "post_number": 541, "post_type": 1, "posts_count": 614, "updated_at": "2025-02-16T13:22:14.284Z", "reply_count": 1, "reply_to_post_number": null, "quote_count": 0, "incoming_link_count": 1, "reads": 101, "readers_count": 100, "score": 29.8, "yours": false, "topic_id": 164277, "topic_slug": "project-1-llm-based-automation-agent-discussion-thread-tds-jan-2025", "display_username": "Manav Singh", "primary_group_name": "ds-students", "flair_name": "ds-students", "flair_url": null, "flair_bg_color": "", "flair_color": "", "flair_group_id": 294, "badges_granted": [], "version": 1, "can_edit": false, "can_delete": false, "can_recover": false, "can_see_hidden_post": false, "can_wiki": false, "link_counts": [{"url": "https://aiproxy.sanand.workers.dev/", "internal": false, "reflection": false, "title": "AI Proxy", "clicks": 1}], "read": true, "user_title": "", "bookmarked": false, "actions_summary": [{"id": 2, "can_act": true}, {"id": 6, "can_act": true}, {"id": 3, "can_act": true}, {"id": 4, "can_act": true}, {"id": 8, "can_act": true}, {"id": 10, "can_act": true}, {"id": 7, "can_act": true}], "moderator": false, "admin": false, "staff": false, "user_id": 7004, "hidden": false, "trust_level": 1, "deleted_at": null, "user_deleted": false, "edit_reason": null, "can_view_edit_history": true, "wiki": false, "post_url": "/t/project-1-llm-based-automation-agent-discussion-thread-tds-jan-2025/164277/541", "user_cakedate": "2021-09-09", "reactions": [], "current_user_reaction": null, "reaction_users_count": 0, "current_user_used_main_reaction": false, "can_accept_answer": false, "can_unaccept_answer": false, "accepted_answer": false, "topic_accepted_answer": null}