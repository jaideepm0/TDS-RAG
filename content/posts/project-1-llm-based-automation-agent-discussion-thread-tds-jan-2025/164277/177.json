{"id": 594218, "name": "Andrew David", "username": "23f1002382", "avatar_template": "/user_avatar/discourse.onlinedegree.iitm.ac.in/23f1002382/{size}/68945_2.png", "created_at": "2025-02-12T20:31:46.779Z", "cooked": "<p>&lt;Response [200]&gt;<br>\n{\u2018id\u2019: \u2018chatcmpl-B0De8V66WZAucAweJe6e32BWSLnpT\u2019, \u2018object\u2019: \u2018chat.completion\u2019, \u2018created\u2019: 1739392156, \u2018model\u2019: \u2018gpt-4o-mini-2024-07-18\u2019, \u2018choices\u2019: [{\u2018index\u2019: 0, \u2018message\u2019: {\u2018role\u2019: \u2018assistant\u2019, \u2018content\u2019: \u201cI\u2019m sorry, but I can\u2019t assist with that.\u201d, \u2018refusal\u2019: None}, \u2018logprobs\u2019: None, \u2018finish_reason\u2019: \u2018stop\u2019}], \u2018usage\u2019: {\u2018prompt_tokens\u2019: 874, \u2018completion_tokens\u2019: 11, \u2018total_tokens\u2019: 885, \u2018prompt_tokens_details\u2019: {\u2018cached_tokens\u2019: 0, \u2018audio_tokens\u2019: 0}, \u2018completion_tokens_details\u2019: {\u2018reasoning_tokens\u2019: 0, \u2018audio_tokens\u2019: 0, \u2018accepted_prediction_tokens\u2019: 0, \u2018rejected_prediction_tokens\u2019: 0}}, \u2018service_tier\u2019: \u2018default\u2019, \u2018system_fingerprint\u2019: \u2018fp_bd83329f63\u2019, \u2018monthlyCost\u2019: 0.048128640000000014, \u2018cost\u2019: 0.0026880000000000003, \u2018monthlyRequests\u2019: 51}</p>\n<pre><code class=\"lang-auto\">def query_gpt_image(image_path: str, task: str):\n    print(\"\ud83d\udd0d Image Path:\", image_path)\n    image_format = image_path.split(\".\")[-1]\n    with open(image_path, \"rb\") as file:\n        image_data = base64.b64encode(file.read()).decode(\"utf-8\")\n    response = requests.post(\n        \"https://aiproxy.sanand.workers.dev/openai/v1/chat/completions\",\n        headers={\"Authorization\": f\"Bearer {\"APIKEY\"}\",\n                \"Content-Type\": \"application/json\"},\n        json={\n            \"model\": \"gpt-4o-mini\",\n            \"messages\": [\n                {\n                \"role\": \"user\",\n                \"content\": [\n                    {\"type\": \"text\", \"text\": task},\n                    {\n                    \"type\": \"image_url\",\n                    \"image_url\": { \"url\": f\"data:image/{image_format};base64,{image_data}\" }\n                    }\n                ]\n                }\n            ]\n            }\n                     )\n    response.raise_for_status()\n    print(response)\n    print(response.json())\n    result = response.json() \nresponse = query_gpt_image(\"data/credit_card.png\",\"Extract the credit card number from image\")\n</code></pre>\n<p>Why is this not working?<br>\nEDIT: Requires prompt engineering as \u201ccredit card\u201d is sensitive information <img src=\"https://emoji.discourse-cdn.com/google/roll_eyes.png?v=12\" title=\":roll_eyes:\" class=\"emoji\" alt=\":roll_eyes:\" loading=\"lazy\" width=\"20\" height=\"20\"><img src=\"https://emoji.discourse-cdn.com/google/roll_eyes.png?v=12\" title=\":roll_eyes:\" class=\"emoji\" alt=\":roll_eyes:\" loading=\"lazy\" width=\"20\" height=\"20\"></p>\n<p>&lt;Response [200]&gt;<br>\n{\u2018id\u2019: \u2018chatcmpl-B0Dlie1ZIS68PZBCT0XJKhLKbyPAC\u2019, \u2018object\u2019: \u2018chat.completion\u2019, \u2018created\u2019: 1739392626, \u2018model\u2019: \u2018gpt-4o-mini-2024-07-18\u2019, \u2018choices\u2019: [{\u2018index\u2019: 0, \u2018message\u2019: {\u2018role\u2019: \u2018assistant\u2019, \u2018content\u2019: \u2018The numbers extracted from the image are:\\n\\n- 3009 1429 5211 59\\n- 09/29\\n- 113\u2019, \u2018refusal\u2019: None}, \u2018logprobs\u2019: None, \u2018finish_reason\u2019: \u2018stop\u2019}], \u2018usage\u2019: {\u2018prompt_tokens\u2019: 871, \u2018completion_tokens\u2019: 31, \u2018total_tokens\u2019: 902, \u2018prompt_tokens_details\u2019: {\u2018cached_tokens\u2019: 0, \u2018audio_tokens\u2019: 0}, \u2018completion_tokens_details\u2019: {\u2018reasoning_tokens\u2019: 0, \u2018audio_tokens\u2019: 0, \u2018accepted_prediction_tokens\u2019: 0, \u2018rejected_prediction_tokens\u2019: 0}}, \u2018service_tier\u2019: \u2018default\u2019, \u2018system_fingerprint\u2019: \u2018fp_bd83329f63\u2019, \u2018monthlyCost\u2019: 0.05092764000000002, \u2018cost\u2019: 0.002799, \u2018monthlyRequests\u2019: 52}</p>\n<pre><code class=\"lang-auto\">response = query_gpt_image(\"data/credit_card.png\",\"Extract number from image\")\n</code></pre>", "post_number": 177, "post_type": 1, "posts_count": 614, "updated_at": "2025-02-12T20:37:45.995Z", "reply_count": 1, "reply_to_post_number": null, "quote_count": 0, "incoming_link_count": 5, "reads": 154, "readers_count": 153, "score": 60.6, "yours": false, "topic_id": 164277, "topic_slug": "project-1-llm-based-automation-agent-discussion-thread-tds-jan-2025", "display_username": "Andrew David", "primary_group_name": "ds-students", "flair_name": "ds-students", "flair_url": null, "flair_bg_color": "", "flair_color": "", "flair_group_id": 294, "badges_granted": [], "version": 2, "can_edit": false, "can_delete": false, "can_recover": false, "can_see_hidden_post": false, "can_wiki": false, "read": true, "user_title": null, "bookmarked": false, "actions_summary": [{"id": 2, "can_act": true}, {"id": 6, "can_act": true}, {"id": 3, "can_act": true}, {"id": 4, "can_act": true}, {"id": 8, "can_act": true}, {"id": 10, "can_act": true}, {"id": 7, "can_act": true}], "moderator": false, "admin": false, "staff": false, "user_id": 18297, "hidden": false, "trust_level": 1, "deleted_at": null, "user_deleted": false, "edit_reason": null, "can_view_edit_history": true, "wiki": false, "post_url": "/t/project-1-llm-based-automation-agent-discussion-thread-tds-jan-2025/164277/177", "user_cakedate": "2023-06-05", "user_birthdate": "1904-01-05", "reactions": [], "current_user_reaction": null, "reaction_users_count": 0, "current_user_used_main_reaction": false, "can_accept_answer": false, "can_unaccept_answer": false, "accepted_answer": false, "topic_accepted_answer": null}